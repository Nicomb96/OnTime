{% extends 'ontime_app/base.html' %}
{% load static %}

{% block title %}Subir Justificativo - OnTime{% endblock %}

{% block content %}
<div class="mt-6 text-center">
  {# Enlace que utiliza JavaScript para regresar a la página anterior en el historial del navegador #}
  <a href="javascript:history.back()" class="flex items-center text-gray-600 hover:text-green-800 transition-all duration-300">
      <i class="fas fa-arrow-left mr-2"></i> {# Icono de flecha izquierda de Font Awesome #}
      Regresar
  </a>
</div>

{# Contenedor principal del formulario para subir justificativos, con estilos Tailwind CSS #}
<div class="bg-gray-100 shadow-xl rounded-3xl p-6 md:p-10 w-full max-w-4xl mx-auto mt-18">
    
    {# Título principal de la sección, con estilos y animación de pulso #}
    <h2 class="text-4xl font-extrabold text-gray-800 text-center mb-6 animate-pulse">Sube tu Justificativo</h2>
    <p class="text-center text-gray-600 mb-8">Envía tu soporte para justificar ausencias o retrasos.</p>

    <div class="bg-white shadow-xl rounded-lg p-6">
      {# Formulario de envío, el `action` está vacío ya que se simula el envío con JS. Debería apuntar a una URL de Django. #}
      <form action="#" method="POST" class="space-y-6">
        {% csrf_token %} {# Token de seguridad requerido por Django para proteger contra ataques CSRF #}
        <div>
          <label for="tipo_justificativo" class="block text-sm font-medium text-gray-700">Tipo de Justificativo</label>
          {# Selector desplegable para elegir el tipo de justificativo #}
          <select id="tipo_justificativo" name="tipo_justificativo" class="w-full p-3 mt-1 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 hover:bg-gray-50 text-gray-600">
            <option value="medico">Médico</option>
            <option value="personal">Personal</option>
            <option value="familia">Familiar</option>
            <option value="otro">Otro</option>
          </select>
        </div>

        <div>
          <label for="fecha_ausencia" class="block text-sm font-medium text-gray-700">Fecha de la Ausencia</label>
          {# Campo de entrada para seleccionar la fecha de la ausencia #}
          <input type="date" id="fecha_ausencia" name="fecha_ausencia" class="w-full p-3 mt-1 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 hover:bg-gray-50 text-gray-600" required />
        </div>

        <div>
          <label for="descripcion" class="block text-sm font-medium text-gray-700">Descripción del Justificativo</label>
          {# Área de texto para la descripción del justificativo #}
          <textarea id="descripcion" name="descripcion" rows="4" class="w-full p-3 mt-1 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 hover:bg-gray-50 text-gray-600" placeholder="Escribe aquí el motivo de tu ausencia..." required></textarea>
        </div>

        <div>
          <label for="archivo" class="block text-sm font-medium text-gray-700">Sube tu archivo (PDF, Imagen)</label>
          {# Campo de entrada para subir el archivo (PDF, JPG, JPEG, PNG) #}
          <input type="file" id="archivo" name="archivo" accept=".pdf, .jpg, .jpeg, .png" class="w-full p-3 mt-1 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 hover:bg-gray-50 text-gray-400" />
        </div>

        <div class="flex justify-center">
          {# Botón de envío del formulario #}
          <button type="submit" class="bg-green-600 text-white py-3 px-6 w-full md:w-auto rounded-lg hover:bg-green-700 transition duration-300 ease-in-out shadow-xl focus:ring-4 focus:ring-green-500 focus:outline-none mt-5">
            Enviar Justificativo
          </button>
        </div>
      </form> {# Cierre de la etiqueta form #}

    {# Mensaje de éxito que se muestra después de simular el envío del formulario, inicialmente oculto #}
    <div class="mt-8 text-center text-green-600 hidden" id="mensaje-exito">
      <p class="text-xl font-medium">¡Justificativo Enviado Exitosamente!</p>
    </div>
  </div> {# Cierre del div con clase bg-white shadow-xl... #}
</div> {# Cierre del div con clase bg-gray-100 shadow-xl... #}

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const form = document.querySelector('form'); // Selecciona el formulario
    const mensajeExito = document.getElementById('mensaje-exito'); // Selecciona el div del mensaje de éxito

    form.addEventListener('submit', function (e) {
      e.preventDefault(); // Evita el envío real del formulario para simular éxito

      // Comportamiento actual (simulación de éxito):
      form.reset(); // Resetea todos los campos del formulario
      mensajeExito.classList.remove('hidden'); // Hace visible el mensaje de éxito
      setTimeout(function () {
        mensajeExito.classList.add('hidden'); // Oculta el mensaje después de 3 segundos
      }, 3000);
    });
  });
</script>
{% endblock %}
